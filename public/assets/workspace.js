(function(){function d(h){var j=document.createElement("div");h="on"+h;var i=(h in j);if(!i){j.setAttribute(h,"return;");i=typeof j[h]=="function"}j=null;return i}function f(h){return Object.isElement(h)&&h.nodeName.toUpperCase()=="FORM"}function e(i){if(Object.isElement(i)){var h=i.nodeName.toUpperCase();return h=="INPUT"||h=="SELECT"||h=="TEXTAREA"}else{return false}}var b=d("submit"),g=d("change");if(!b||!g){Event.Handler.prototype.initialize=Event.Handler.prototype.initialize.wrap(function(k,j,i,h,l){k(j,i,h,l);if((!b&&this.eventName=="submit"&&!f(this.element))||(!g&&this.eventName=="change"&&!e(this.element))){this.eventName="emulated:"+this.eventName}})}if(!b){document.on("focusin","form",function(h,i){if(!i.retrieve("emulated:submit")){i.on("submit",function(j){var k=i.fire("emulated:submit",j,true);if(k.returnValue===false){j.preventDefault()}});i.store("emulated:submit",true)}})}if(!g){document.on("focusin","input, select, texarea",function(i,h){if(!h.retrieve("emulated:change")){h.on("change",function(j){h.fire("emulated:change",j,true)});h.store("emulated:change",true)}})}function a(i){var l,h,k;var j=i.fire("ajax:before");if(j.stopped){return false}if(i.tagName.toLowerCase()==="form"){l=i.readAttribute("method")||"post";h=i.readAttribute("action");k=i.serialize()}else{l=i.readAttribute("data-method")||"get";h=i.readAttribute("href");k={}}new Ajax.Request(h,{method:l,parameters:k,evalScripts:true,onComplete:function(m){i.fire("ajax:complete",m)},onSuccess:function(m){i.fire("ajax:success",m)},onFailure:function(m){i.fire("ajax:failure",m)}});i.fire("ajax:after")}function c(m){var h=m.readAttribute("data-method"),i=m.readAttribute("href"),n=$$("meta[name=csrf-param]")[0],p=$$("meta[name=csrf-token]")[0];var j=new Element("form",{method:"POST",action:i,style:"display: none;"});m.parentNode.insert(j);if(h!=="post"){var o=new Element("input",{type:"hidden",name:"_method",value:h});j.insert(o)}if(n){var k=n.readAttribute("content"),l=p.readAttribute("content"),o=new Element("input",{type:"hidden",name:k,value:l});j.insert(o)}j.submit()}document.on("click","*[data-confirm]",function(j,h){var i=h.readAttribute("data-confirm");if(!confirm(i)){j.stop()}});document.on("click","a[data-remote]",function(i,h){if(i.stopped){return}a(h);i.stop()});document.on("click","a[data-method]",function(i,h){if(i.stopped){return}c(h);i.stop()});document.on("submit",function(k){var i=k.findElement(),j=i.readAttribute("data-confirm");if(j&&!confirm(j)){k.stop();return false}var h=i.select("input[type=submit][data-disable-with]");h.each(function(l){l.disabled=true;l.writeAttribute("data-original-value",l.value);l.value=l.readAttribute("data-disable-with")});var i=k.findElement("form[data-remote]");if(i){a(i);k.stop()}});document.on("ajax:after","form",function(j,i){var h=i.select("input[type=submit][disabled=true][data-disable-with]");h.each(function(k){k.value=k.readAttribute("data-original-value");k.removeAttribute("data-original-value");k.disabled=false})});Ajax.Responders.register({onCreate:function(i){var j=$$("meta[name=csrf-token]")[0];if(j){var k="X-CSRF-Token",h=j.readAttribute("content");if(!i.options.requestHeaders){i.options.requestHeaders={}}i.options.requestHeaders[k]=h}}})})();